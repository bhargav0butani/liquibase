name: Rollback changelog

on:  
    workflow_dispatch:
     inputs:
      environment:
        description: 'Select the environment'
        type: choice
        options: [TEST, UAT, PROD]
        required: true
      rollback_date:
        description: 'Enter rollback date (YYYY-MM-DD)'
        required: true

jobs:
  Rollback:
    runs-on: ubuntu-latest
    name: Rollback Action
    steps:
      - uses: actions/checkout@v2
      - uses: liquibase/liquibase-github-action@v2
        with:
          operation: 'rollbackToDate'
          classpath: 'changelog'
          changeLogFile: 'changelog.xml'
          username: ${{ secrets[github.event.inputs.environment + '_USERNAME'] }}
          password: ${{ secrets[github.event.inputs.environment + '_PASSWORD'] }}
          url: ${{ secrets[github.event.inputs.environment + '_URL'] }}
          date: ${{ github.event.inputs.rollback_date }}